<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>AIè‹±è¯­å­¦ä¹ åŠ©æ‰‹</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0f0f23;--card:#1a1a2e;--card2:#16213e;--accent:#4ecdc4;--accent2:#45b7aa;--err:#ff6b6b;--warn:#ffe66d;--text:#e8e8e8;--text2:#a0a0b0;--text3:#6a6a7a;--radius:12px}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;padding-bottom:70px;-webkit-tap-highlight-color:transparent;overflow-x:hidden}
.page{display:none;padding:16px;padding-bottom:80px;animation:fadeIn .3s ease}
.page.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
@keyframes flipIn{from{transform:rotateY(90deg)}to{transform:rotateY(0)}}
/* Nav */
.nav{position:fixed;bottom:0;left:0;right:0;background:var(--card);display:flex;justify-content:space-around;padding:8px 0 env(safe-area-inset-bottom,8px);border-top:1px solid #2a2a4a;z-index:100}
.nav-item{display:flex;flex-direction:column;align-items:center;padding:6px 12px;cursor:pointer;border-radius:8px;transition:.2s;font-size:11px;color:var(--text3);min-width:56px}
.nav-item.active{color:var(--accent)}
.nav-item .icon{font-size:22px;margin-bottom:2px}
/* Cards */
.stat-card{background:var(--card);border-radius:var(--radius);padding:16px;margin-bottom:12px}
.stat-row{display:flex;gap:10px;margin-bottom:12px}
.stat-box{flex:1;background:var(--card2);border-radius:10px;padding:14px;text-align:center}
.stat-num{font-size:28px;font-weight:700;color:var(--accent);line-height:1.2}
.stat-label{font-size:12px;color:var(--text2);margin-top:4px}
/* Buttons */
.btn{display:inline-flex;align-items:center;justify-content:center;padding:14px 24px;border:none;border-radius:var(--radius);font-size:16px;font-weight:600;cursor:pointer;transition:.2s;width:100%;color:#fff}
.btn-primary{background:linear-gradient(135deg,var(--accent),var(--accent2))}
.btn-primary:active{transform:scale(.97)}
.btn-danger{background:var(--err)}
.btn-sm{padding:10px 16px;font-size:14px;width:auto}
.btn-outline{background:transparent;border:1px solid var(--text3);color:var(--text2)}
/* Flashcard */
.fc-container{perspective:1000px;margin:20px 0}
.fc-card{position:relative;min-height:260px;cursor:pointer;transition:transform .5s;transform-style:preserve-3d}
.fc-card.flipped{transform:rotateY(180deg)}
.fc-face{position:absolute;inset:0;backface-visibility:hidden;border-radius:var(--radius);padding:24px;display:flex;flex-direction:column;justify-content:center;align-items:center}
.fc-front{background:linear-gradient(145deg,#1e1e3a,#16213e);border:1px solid #2a2a4a}
.fc-back{background:linear-gradient(145deg,#1a2a3e,#162e3e);border:1px solid #1a4a4a;transform:rotateY(180deg)}
.fc-word{font-size:32px;font-weight:700;color:#fff;margin-bottom:8px;text-align:center}
.fc-hint{font-size:13px;color:var(--text3);margin-top:8px}
.fc-cn{font-size:24px;font-weight:600;color:var(--accent);margin-bottom:12px;text-align:center}
.fc-ex{font-size:14px;color:var(--text2);line-height:1.6;text-align:center;margin-bottom:4px}
.fc-excn{font-size:13px;color:var(--text3);text-align:center}
.fc-phase{position:absolute;top:12px;right:12px;font-size:11px;padding:3px 8px;border-radius:20px;background:rgba(78,205,196,.15);color:var(--accent)}
.fc-btns{display:flex;gap:10px;margin-top:16px}
.fc-btn{flex:1;padding:14px;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;transition:.2s}
.fc-btn:active{transform:scale(.95)}
.fc-btn.wrong{background:#3a1a1a;color:var(--err)}
.fc-btn.fuzzy{background:#3a3a1a;color:var(--warn)}
.fc-btn.right{background:#1a3a2a;color:#4ecdc4}
.fc-progress{height:4px;background:#2a2a4a;border-radius:2px;margin:12px 0;overflow:hidden}
.fc-progress-bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));border-radius:2px;transition:width .3s}
.fc-stats{display:flex;justify-content:space-between;font-size:12px;color:var(--text3)}
.fc-done{text-align:center;padding:40px 20px}
.fc-done-icon{font-size:48px;margin-bottom:16px}
.fc-done-text{font-size:18px;color:var(--text);margin-bottom:8px}
/* Grammar */
.grammar-item{background:var(--card);border-radius:var(--radius);margin-bottom:10px;overflow:hidden}
.grammar-header{padding:16px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-weight:600;font-size:15px}
.grammar-header .arrow{transition:transform .3s;color:var(--text3)}
.grammar-item.open .arrow{transform:rotate(180deg)}
.grammar-body{max-height:0;overflow:hidden;transition:max-height .4s ease}
.grammar-item.open .grammar-body{max-height:800px}
.grammar-desc{padding:0 16px 12px;font-size:14px;color:var(--text2);line-height:1.7}
.grammar-ex{padding:8px 16px;background:var(--card2);margin:0 12px 8px;border-radius:8px;border-left:3px solid var(--accent)}
.grammar-ex .en{font-size:14px;color:#fff;margin-bottom:4px}
.grammar-ex .cn{font-size:13px;color:var(--text3);margin-bottom:4px}
.grammar-ex .note{font-size:12px;color:var(--accent);opacity:.7}
.grammar-ex:last-child{margin-bottom:16px}
/* Plan */
.timeline{position:relative;padding-left:24px}
.timeline::before{content:'';position:absolute;left:8px;top:0;bottom:0;width:2px;background:#2a2a4a}
.phase-block{margin-bottom:20px;position:relative}
.phase-dot{position:absolute;left:-20px;top:4px;width:12px;height:12px;border-radius:50%;background:var(--text3);border:2px solid var(--bg)}
.phase-dot.active{background:var(--accent)}
.phase-dot.done{background:#4ecdc4}
.phase-title{font-size:16px;font-weight:600;margin-bottom:8px}
.milestone{display:flex;align-items:center;padding:8px 0;font-size:14px;color:var(--text2);cursor:pointer}
.milestone input{margin-right:10px;width:18px;height:18px;accent-color:var(--accent)}
/* Settings */
.setting-group{background:var(--card);border-radius:var(--radius);padding:16px;margin-bottom:12px}
.setting-label{font-size:14px;color:var(--text2);margin-bottom:8px;display:flex;justify-content:space-between}
.setting-label span{color:var(--accent);font-weight:600}
input[type=range]{width:100%;height:6px;appearance:none;background:#2a2a4a;border-radius:3px;outline:none;margin:8px 0}
input[type=range]::-webkit-slider-thumb{appearance:none;width:22px;height:22px;border-radius:50%;background:var(--accent);cursor:pointer}
.tool-card{background:var(--card2);border-radius:10px;padding:14px;margin-bottom:10px}
.tool-name{font-size:15px;font-weight:600;color:var(--accent);margin-bottom:4px}
.tool-desc{font-size:13px;color:var(--text2);line-height:1.5;margin-bottom:6px}
.tool-tip{font-size:12px;color:var(--text3);padding:8px;background:rgba(78,205,196,.05);border-radius:6px;border-left:2px solid var(--accent)}
.tool-url{font-size:12px;color:var(--accent);text-decoration:none;display:inline-block;margin-top:4px}
/* Modal */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:200;justify-content:center;align-items:center}
.modal-overlay.show{display:flex}
.modal{background:var(--card);border-radius:16px;padding:24px;margin:20px;max-width:340px;width:100%;text-align:center}
.modal h3{margin-bottom:12px;font-size:18px}
.modal p{color:var(--text2);font-size:14px;margin-bottom:20px;line-height:1.5}
.modal-btns{display:flex;gap:10px}
.modal-btns .btn{flex:1}
/* Misc */
h2{font-size:20px;margin-bottom:16px;font-weight:700}
.section-title{font-size:13px;color:var(--text3);text-transform:uppercase;letter-spacing:1px;margin:16px 0 8px}
.empty-state{text-align:center;padding:40px;color:var(--text3)}
.phase-badge{display:inline-block;padding:4px 12px;border-radius:20px;font-size:13px;font-weight:600;margin-bottom:12px}
.phase-1{background:rgba(78,205,196,.15);color:#4ecdc4}
.phase-2{background:rgba(255,230,109,.15);color:#ffe66d}
.phase-3{background:rgba(255,107,107,.15);color:#ff6b6b}
.greeting{font-size:24px;font-weight:700;margin-bottom:4px}
.subtext{font-size:14px;color:var(--text2);margin-bottom:16px}
.streak-fire{font-size:36px;display:block;margin-bottom:4px}
</style>
</head>
<body>

<!-- ===== PAGES ===== -->

<!-- HOME -->
<div id="pg-home" class="page active">
  <div class="greeting" id="greeting">AIè‹±è¯­å­¦ä¹ åŠ©æ‰‹</div>
  <div class="subtext">æ¯å¤©15åˆ†é’Ÿï¼Œ6ä¸ªæœˆè¯»æ‡‚AIè‹±æ–‡</div>
  
  <div class="stat-card">
    <div class="stat-row">
      <div class="stat-box">
        <div class="streak-fire">ğŸ”¥</div>
        <div class="stat-num" id="streak">0</div>
        <div class="stat-label">è¿ç»­å¤©æ•°</div>
      </div>
      <div class="stat-box">
        <div class="stat-num" id="learned">0</div>
        <div class="stat-label">å·²å­¦å•è¯</div>
      </div>
      <div class="stat-box">
        <div class="stat-num" id="total-words">131</div>
        <div class="stat-label">æ€»è¯æ±‡é‡</div>
      </div>
    </div>
    <div id="phase-indicator"></div>
  </div>

  <div class="stat-card">
    <div style="font-size:15px;font-weight:600;margin-bottom:8px">ğŸ“‹ ä»Šæ—¥ä»»åŠ¡</div>
    <div id="today-tasks" style="font-size:14px;color:var(--text2);line-height:1.8"></div>
  </div>

  <button class="btn btn-primary" onclick="startStudy()" style="margin-top:8px">
    â–¶ï¸ å¼€å§‹ä»Šæ—¥å­¦ä¹ 
  </button>

  <div class="stat-card" style="margin-top:12px">
    <div style="font-size:13px;color:var(--text3);line-height:1.6">
      ğŸ’¡ <strong>è¾…åŠ©å·¥å…·</strong>ï¼šé‡åˆ°ä¸ç†è§£çš„è¯­æ³•æˆ–å¥å­ï¼Œæ‰“å¼€ <a href="https://chat.deepseek.com" target="_blank" style="color:var(--accent)">DeepSeek</a>ï¼ˆå®Œå…¨å…è´¹ï¼‰ï¼ŒæŠŠå¥å­ç²˜è´´è¿‡å»è®©å®ƒå¸®ä½ åˆ†æã€‚
    </div>
  </div>
</div>

<!-- CARDS -->
<div id="pg-cards" class="page">
  <h2>ğŸ“‡ å•è¯å¡ç‰‡</h2>
  <div class="fc-stats">
    <span id="fc-count">0 / 0</span>
    <span id="fc-new-count">æ–°è¯: 0</span>
  </div>
  <div class="fc-progress"><div class="fc-progress-bar" id="fc-bar" style="width:0%"></div></div>
  
  <div class="fc-container" id="fc-area">
    <div class="fc-card" id="fc-card" onclick="flipCard()">
      <div class="fc-face fc-front">
        <div class="fc-phase" id="fc-phase-tag"></div>
        <div class="fc-word" id="fc-word"></div>
        <div class="fc-hint">ğŸ‘† ç‚¹å‡»ç¿»è½¬æŸ¥çœ‹é‡Šä¹‰</div>
      </div>
      <div class="fc-face fc-back">
        <div class="fc-cn" id="fc-cn"></div>
        <div class="fc-ex" id="fc-ex"></div>
        <div class="fc-excn" id="fc-excn"></div>
      </div>
    </div>
  </div>

  <div class="fc-btns" id="fc-btns" style="display:none">
    <button class="fc-btn wrong" onclick="answer(0)">âŒ ä¸è®¤è¯†</button>
    <button class="fc-btn fuzzy" onclick="answer(1)">ğŸ¤” æ¨¡ç³Š</button>
    <button class="fc-btn right" onclick="answer(2)">âœ… è®¤è¯†</button>
  </div>

  <div class="fc-done" id="fc-done" style="display:none">
    <div class="fc-done-icon">ğŸ‰</div>
    <div class="fc-done-text">ä»Šæ—¥å­¦ä¹ å®Œæˆï¼</div>
    <div style="color:var(--text2);font-size:14px;margin-bottom:16px" id="fc-summary"></div>
    <button class="btn btn-outline btn-sm" onclick="goHome()">è¿”å›é¦–é¡µ</button>
  </div>
</div>

<!-- GRAMMAR -->
<div id="pg-grammar" class="page">
  <h2>ğŸ“ è¯­æ³•éª¨æ¶</h2>
  <div class="subtext">æŒæ¡è¿™5ä¸ªå¥å¼ï¼Œè¯»æ‡‚80%çš„æŠ€æœ¯æ–‡ç« </div>
  <div id="grammar-list"></div>
</div>

<!-- PLAN -->
<div id="pg-plan" class="page">
  <h2>ğŸ“… å­¦ä¹ è®¡åˆ’</h2>
  <div class="subtext">6ä¸ªæœˆ Â· 3ä¸ªé˜¶æ®µ Â· ä»é›¶åˆ°ç‹¬ç«‹é˜…è¯»</div>
  <div id="plan-content"></div>
</div>

<!-- SETTINGS -->
<div id="pg-settings" class="page">
  <h2>âš™ï¸ è®¾ç½®</h2>
  
  <div class="setting-group">
    <div class="setting-label">æ¯æ—¥æ–°è¯æ•°é‡ <span id="new-val">10</span></div>
    <input type="range" min="5" max="20" value="10" id="new-slider" oninput="updateSetting('new',this.value)">
    <div class="setting-label" style="margin-top:12px">æ¯æ—¥å¤ä¹ ä¸Šé™ <span id="rev-val">50</span></div>
    <input type="range" min="20" max="100" value="50" id="rev-slider" oninput="updateSetting('rev',this.value)">
  </div>

  <div class="setting-group">
    <div style="font-size:15px;font-weight:600;margin-bottom:12px">ğŸ“¦ æ•°æ®ç®¡ç†</div>
    <button class="btn btn-outline btn-sm" onclick="exportData()" style="margin-bottom:8px">ğŸ“¤ å¯¼å‡ºå­¦ä¹ æ•°æ®</button>
    <button class="btn btn-outline btn-sm" onclick="document.getElementById('import-file').click()" style="margin-bottom:8px">ğŸ“¥ å¯¼å…¥å­¦ä¹ æ•°æ®</button>
    <input type="file" id="import-file" accept=".json" style="display:none" onchange="importData(event)">
    <button class="btn btn-danger btn-sm" onclick="showModal()">ğŸ—‘ï¸ é‡ç½®æ‰€æœ‰è¿›åº¦</button>
  </div>

  <div class="section-title">ğŸ› ï¸ æ¨èè¾…åŠ©å·¥å…·</div>
  <div id="tools-list"></div>
</div>

<!-- NAV -->
<div class="nav">
  <div class="nav-item active" onclick="go('home')"><span class="icon">ğŸ </span>é¦–é¡µ</div>
  <div class="nav-item" onclick="go('cards')"><span class="icon">ğŸ“‡</span>å•è¯</div>
  <div class="nav-item" onclick="go('grammar')"><span class="icon">ğŸ“</span>è¯­æ³•</div>
  <div class="nav-item" onclick="go('plan')"><span class="icon">ğŸ“…</span>è®¡åˆ’</div>
  <div class="nav-item" onclick="go('settings')"><span class="icon">âš™ï¸</span>è®¾ç½®</div>
</div>

<!-- MODAL -->
<div class="modal-overlay" id="modal">
  <div class="modal">
    <h3>ç¡®è®¤é‡ç½®</h3>
    <p>è¿™å°†æ¸…é™¤æ‰€æœ‰å­¦ä¹ è¿›åº¦ã€å•è¯è®°å½•å’Œè¿ç»­å¤©æ•°ã€‚æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼</p>
    <div class="modal-btns">
      <button class="btn btn-outline btn-sm" onclick="hideModal()">å–æ¶ˆ</button>
      <button class="btn btn-danger btn-sm" onclick="resetAll()">ç¡®è®¤é‡ç½®</button>
    </div>
  </div>
</div>

<script>
// ===== VOCABULARY DATA =====
const V=[
["is","æ˜¯","The model is ready.","æ¨¡å‹å‡†å¤‡å¥½äº†ã€‚",1],
["are","æ˜¯(å¤æ•°)","The results are good.","ç»“æœå¾ˆå¥½ã€‚",1],
["was","æ˜¯(è¿‡å»)","It was trained yesterday.","å®ƒæ˜¨å¤©è¢«è®­ç»ƒäº†ã€‚",1],
["have","æœ‰","We have enough data.","æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„æ•°æ®ã€‚",1],
["can","èƒ½","This model can generate text.","è¿™ä¸ªæ¨¡å‹èƒ½ç”Ÿæˆæ–‡æœ¬ã€‚",1],
["will","å°†","We will train a new model.","æˆ‘ä»¬å°†è®­ç»ƒæ–°æ¨¡å‹ã€‚",1],
["should","åº”è¯¥","You should use more data.","ä½ åº”è¯¥ç”¨æ›´å¤šæ•°æ®ã€‚",1],
["need","éœ€è¦","We need more training data.","æˆ‘ä»¬éœ€è¦æ›´å¤šè®­ç»ƒæ•°æ®ã€‚",1],
["must","å¿…é¡»","You must preprocess the data.","ä½ å¿…é¡»é¢„å¤„ç†æ•°æ®ã€‚",1],
["want","æƒ³è¦","I want to fine-tune this model.","æˆ‘æƒ³å¾®è°ƒè¿™ä¸ªæ¨¡å‹ã€‚",1],
["and","å’Œ","Training and testing are important.","è®­ç»ƒå’Œæµ‹è¯•éƒ½å¾ˆé‡è¦ã€‚",1],
["or","æˆ–","Use GPU or TPU for training.","ç”¨GPUæˆ–TPUè®­ç»ƒã€‚",1],
["but","ä½†æ˜¯","The model is fast but not accurate.","æ¨¡å‹å¿«ä½†ä¸å‡†ç¡®ã€‚",1],
["if","å¦‚æœ","If the loss decreases, it's learning.","å¦‚æœæŸå¤±ä¸‹é™å°±åœ¨å­¦ä¹ ã€‚",1],
["because","å› ä¸º","It failed because of bad data.","å› ä¸ºæ•°æ®å·®æ‰€ä»¥å¤±è´¥ã€‚",1],
["so","æ‰€ä»¥","Data is clean, so results are good.","æ•°æ®å¹²å‡€æ‰€ä»¥ç»“æœå¥½ã€‚",1],
["however","ç„¶è€Œ","However, the model is too slow.","ç„¶è€Œæ¨¡å‹å¤ªæ…¢äº†ã€‚",1],
["also","ä¹Ÿ","This also works for images.","è¿™ä¹Ÿé€‚ç”¨äºå›¾åƒã€‚",1],
["then","ç„¶å","First load data, then train.","å…ˆåŠ è½½æ•°æ®ç„¶åè®­ç»ƒã€‚",1],
["when","å½“â€¦æ—¶","When training is done, save it.","è®­ç»ƒå®Œæˆåä¿å­˜å®ƒã€‚",1],
["in","åœ¨â€¦é‡Œ","In this paper, we propose a method.","åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬æå‡ºæ–¹æ³•ã€‚",1],
["on","åœ¨â€¦ä¸Š","The model runs on GPU.","æ¨¡å‹åœ¨GPUä¸Šè¿è¡Œã€‚",1],
["to","åˆ°","Send data to the server.","æŠŠæ•°æ®å‘åˆ°æœåŠ¡å™¨ã€‚",1],
["from","ä»","Download the model from website.","ä»ç½‘ç«™ä¸‹è½½æ¨¡å‹ã€‚",1],
["with","ç”¨","Train the model with more data.","ç”¨æ›´å¤šæ•°æ®è®­ç»ƒæ¨¡å‹ã€‚",1],
["by","é€šè¿‡","Accuracy improved by fine-tuning.","å‡†ç¡®ç‡é€šè¿‡å¾®è°ƒæå‡ã€‚",1],
["for","ä¸ºäº†","This tool is for data analysis.","è¿™å·¥å…·ç”¨äºæ•°æ®åˆ†æã€‚",1],
["of","çš„","The accuracy of the model is 95%.","æ¨¡å‹å‡†ç¡®ç‡95%ã€‚",1],
["about","å…³äº","This article is about deep learning.","æœ¬æ–‡å…³äºæ·±åº¦å­¦ä¹ ã€‚",1],
["at","åœ¨","Training stops at 100 epochs.","è®­ç»ƒåœ¨100è½®æ—¶åœæ­¢ã€‚",1],
["this","è¿™ä¸ª","This method is very effective.","æ–¹æ³•éå¸¸æœ‰æ•ˆã€‚",1],
["that","é‚£ä¸ª","That approach was proposed in 2023.","é‚£æ–¹æ³•2023å¹´æå‡ºã€‚",1],
["it","å®ƒ","It performs better than GPT-3.","å®ƒæ¯”GPT-3å¥½ã€‚",1],
["they","å®ƒä»¬","They released a new version.","ä»–ä»¬å‘å¸ƒäº†æ–°ç‰ˆæœ¬ã€‚",1],
["we","æˆ‘ä»¬","We trained the model for 3 days.","æˆ‘ä»¬è®­ç»ƒäº†3å¤©ã€‚",1],
["all","æ‰€æœ‰","All experiments are done.","æ‰€æœ‰å®éªŒå®Œæˆäº†ã€‚",1],
["new","æ–°çš„","A new model was released.","æ–°æ¨¡å‹å‘å¸ƒäº†ã€‚",1],
["large","å¤§çš„","We use a large dataset.","æˆ‘ä»¬ç”¨å¤§æ•°æ®é›†ã€‚",1],
["small","å°çš„","A small model runs faster.","å°æ¨¡å‹è·‘å¾—æ›´å¿«ã€‚",1],
["high","é«˜çš„","The accuracy is high.","å‡†ç¡®ç‡å¾ˆé«˜ã€‚",1],
["low","ä½çš„","The loss is very low.","æŸå¤±éå¸¸ä½ã€‚",1],
["more","æ›´å¤š","We need more compute.","éœ€è¦æ›´å¤šç®—åŠ›ã€‚",1],
["very","éå¸¸","The model is very fast.","æ¨¡å‹éå¸¸å¿«ã€‚",1],
["first","é¦–å…ˆ","First, prepare the dataset.","é¦–å…ˆå‡†å¤‡æ•°æ®é›†ã€‚",1],
["next","ä¸‹ä¸€","The next step is training.","ä¸‹ä¸€æ­¥æ˜¯è®­ç»ƒã€‚",1],
["already","å·²ç»","The model is already trained.","æ¨¡å‹å·²ç»è®­ç»ƒå¥½äº†ã€‚",1],
["model","æ¨¡å‹","This model can understand text.","æ¨¡å‹èƒ½ç†è§£æ–‡æœ¬ã€‚",1],
["data","æ•°æ®","We collected a lot of data.","æˆ‘ä»¬æ”¶é›†äº†å¤§é‡æ•°æ®ã€‚",1],
["training","è®­ç»ƒ","Training takes a long time.","è®­ç»ƒè€—æ—¶å¾ˆé•¿ã€‚",1],
["network","ç½‘ç»œ","A neural network has many layers.","ç¥ç»ç½‘ç»œæœ‰å¾ˆå¤šå±‚ã€‚",1],
["algorithm","ç®—æ³•","This algorithm is very efficient.","ç®—æ³•éå¸¸é«˜æ•ˆã€‚",1],
["parameter","å‚æ•°","The model has millions of parameters.","æ¨¡å‹æœ‰æ•°ç™¾ä¸‡å‚æ•°ã€‚",1],
["accuracy","å‡†ç¡®ç‡","Accuracy reached 98%.","å‡†ç¡®ç‡è¾¾åˆ°98%ã€‚",1],
["result","ç»“æœ","The results are very promising.","ç»“æœä»¤äººæœŸå¾…ã€‚",1],
["method","æ–¹æ³•","We propose a new method.","æˆ‘ä»¬æå‡ºæ–°æ–¹æ³•ã€‚",1],
["task","ä»»åŠ¡","This is a classification task.","è¿™æ˜¯åˆ†ç±»ä»»åŠ¡ã€‚",1],
["error","è¯¯å·®","The error rate is 2%.","è¯¯å·®ç‡æ˜¯2%ã€‚",1],
["feature","ç‰¹å¾","Extract features from data.","ä»æ•°æ®æå–ç‰¹å¾ã€‚",1],
["dataset","æ•°æ®é›†","The dataset has 1M images.","æ•°æ®é›†æœ‰100ä¸‡å›¾ã€‚",1],
["input","è¾“å…¥","The input is a text string.","è¾“å…¥æ˜¯æ–‡æœ¬å­—ç¬¦ä¸²ã€‚",1],
["output","è¾“å‡º","The output is a prediction.","è¾“å‡ºæ˜¯é¢„æµ‹ç»“æœã€‚",1],
["function","å‡½æ•°","This function processes data.","å‡½æ•°å¤„ç†æ•°æ®ã€‚",1],
["performance","æ€§èƒ½","Performance improved a lot.","æ€§èƒ½æå‡å¾ˆå¤šã€‚",1],
["system","ç³»ç»Ÿ","This is an AI-powered system.","è¿™æ˜¯AIç³»ç»Ÿã€‚",1],
["label","æ ‡ç­¾","Each sample has a label.","æ¯æ ·æœ¬æœ‰æ ‡ç­¾ã€‚",1],
["value","å€¼","The loss value is decreasing.","æŸå¤±å€¼åœ¨ä¸‹é™ã€‚",1],
["neural network","ç¥ç»ç½‘ç»œ","A neural network learns from data.","ç¥ç»ç½‘ç»œä»æ•°æ®å­¦ä¹ ã€‚",1],
["deep learning","æ·±åº¦å­¦ä¹ ","Deep learning needs large datasets.","æ·±åº¦å­¦ä¹ éœ€è¦å¤§æ•°æ®é›†ã€‚",1],
["machine learning","æœºå™¨å­¦ä¹ ","Machine learning is a branch of AI.","æœºå™¨å­¦ä¹ æ˜¯AIçš„åˆ†æ”¯ã€‚",1],
["transformer","Transformer","GPT is based on the transformer.","GPTåŸºäºTransformerã€‚",1],
["attention","æ³¨æ„åŠ›æœºåˆ¶","Attention helps the model focus.","æ³¨æ„åŠ›å¸®åŠ©æ¨¡å‹èšç„¦ã€‚",1],
["token","è¯å…ƒ","Each word is split into tokens.","è¯è¢«æ‹†åˆ†æˆè¯å…ƒã€‚",1],
["embedding","åµŒå…¥å‘é‡","Word embeddings capture meaning.","è¯åµŒå…¥æ•æ‰è¯­ä¹‰ã€‚",1],
["prompt","æç¤ºè¯","Write a good prompt for the AI.","ä¸ºAIå†™å¥½æç¤ºè¯ã€‚",1],
["fine-tuning","å¾®è°ƒ","Fine-tuning improves performance.","å¾®è°ƒæå‡æ€§èƒ½ã€‚",1],
["pre-training","é¢„è®­ç»ƒ","Pre-training uses large text data.","é¢„è®­ç»ƒç”¨å¤§é‡æ–‡æœ¬ã€‚",1],
["inference","æ¨ç†","Inference is faster than training.","æ¨ç†æ¯”è®­ç»ƒå¿«ã€‚",1],
["overfitting","è¿‡æ‹Ÿåˆ","Overfitting means memorizing data.","è¿‡æ‹ŸåˆæŒ‡è®°ä½æ•°æ®ã€‚",1],
["loss function","æŸå¤±å‡½æ•°","The loss function measures error.","æŸå¤±å‡½æ•°è¡¡é‡è¯¯å·®ã€‚",1],
["optimization","ä¼˜åŒ–","Optimization finds best parameters.","ä¼˜åŒ–æ‰¾æœ€ä½³å‚æ•°ã€‚",1],
["weight","æƒé‡","Each connection has a weight.","æ¯ä¸ªè¿æ¥æœ‰æƒé‡ã€‚",1],
["layer","å±‚","This network has 12 layers.","ç½‘ç»œæœ‰12å±‚ã€‚",1],
["epoch","è½®æ¬¡","Train for 100 epochs.","è®­ç»ƒ100ä¸ªè½®æ¬¡ã€‚",1],
["batch","æ‰¹æ¬¡","Each batch has 32 samples.","æ¯æ‰¹æœ‰32ä¸ªæ ·æœ¬ã€‚",1],
["hallucination","å¹»è§‰","AI sometimes produces hallucinations.","AIæœ‰æ—¶äº§ç”Ÿå¹»è§‰ã€‚",1],
["RAG","æ£€ç´¢å¢å¼ºç”Ÿæˆ","RAG reduces hallucination.","RAGå‡å°‘å¹»è§‰ã€‚",1],
["zero-shot","é›¶æ ·æœ¬","Zero-shot means no examples given.","é›¶æ ·æœ¬å³ä¸ç»™ç¤ºä¾‹ã€‚",1],
["few-shot","å°‘æ ·æœ¬","Few-shot learning uses 2-5 examples.","å°‘æ ·æœ¬ç”¨2-5ä¸ªä¾‹å­ã€‚",1],
["agent","æ™ºèƒ½ä½“","AI agents can use tools.","AIæ™ºèƒ½ä½“èƒ½ç”¨å·¥å…·ã€‚",1],
["benchmark","åŸºå‡†æµ‹è¯•","We tested on standard benchmarks.","åœ¨æ ‡å‡†åŸºå‡†ä¸Šæµ‹è¯•ã€‚",1],
["API","åº”ç”¨æ¥å£","Call the API to get results.","è°ƒç”¨APIè·å–ç»“æœã€‚",1],
["deploy","éƒ¨ç½²","Deploy the model to production.","éƒ¨ç½²æ¨¡å‹åˆ°ç”Ÿäº§ã€‚",1],
["GPU","æ˜¾å¡","Training requires a powerful GPU.","è®­ç»ƒéœ€å¼ºå¤§æ˜¾å¡ã€‚",1],
["open source","å¼€æº","This model is open source.","æ¨¡å‹æ˜¯å¼€æºçš„ã€‚",1],
["scalable","å¯æ‰©å±•","The system is highly scalable.","ç³»ç»Ÿé«˜åº¦å¯æ‰©å±•ã€‚",1],
["state-of-the-art","æœ€å…ˆè¿›","This is state-of-the-art result.","è¿™æ˜¯æœ€å…ˆè¿›çš„ç»“æœã€‚",1],
["multimodal","å¤šæ¨¡æ€","GPT-4 is a multimodal model.","GPT-4æ˜¯å¤šæ¨¡æ€æ¨¡å‹ã€‚",1],
["train","è®­ç»ƒ(åŠ¨è¯)","We train the model on data.","åœ¨æ•°æ®ä¸Šè®­ç»ƒæ¨¡å‹ã€‚",1],
["evaluate","è¯„ä¼°","Evaluate on test data.","åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°ã€‚",1],
["generate","ç”Ÿæˆ","The model can generate text.","æ¨¡å‹èƒ½ç”Ÿæˆæ–‡æœ¬ã€‚",1],
["predict","é¢„æµ‹","The model predicts next word.","æ¨¡å‹é¢„æµ‹ä¸‹ä¸€è¯ã€‚",1],
["improve","æ”¹è¿›","We improved accuracy by 5%.","å‡†ç¡®ç‡æå‡äº†5%ã€‚",1],
["implement","å®ç°","Implement this in Python.","ç”¨Pythonå®ç°ã€‚",1],
["configure","é…ç½®","Configure the hyperparameters.","é…ç½®è¶…å‚æ•°ã€‚",1],
["run","è¿è¡Œ","Run the script to start.","è¿è¡Œè„šæœ¬å¼€å§‹ã€‚",1],
["download","ä¸‹è½½","Download the model weights.","ä¸‹è½½æ¨¡å‹æƒé‡ã€‚",1],
["import","å¯¼å…¥","Import the library first.","å…ˆå¯¼å…¥è¿™ä¸ªåº“ã€‚",1],
["based on","åŸºäº","This method is based on transformers.","æ–¹æ³•åŸºäºTransformerã€‚",2],
["compared to","ä¸â€¦ç›¸æ¯”","Compared to GPT-3, GPT-4 is better.","ä¸GPT-3æ¯”GPT-4æ›´å¥½ã€‚",2],
["due to","ç”±äº","Due to limited data, accuracy is low.","ç”±äºæ•°æ®å°‘å‡†ç¡®ç‡ä½ã€‚",2],
["results in","å¯¼è‡´","More data results in better performance.","æ›´å¤šæ•°æ®å¸¦æ¥æ›´å¥½æ€§èƒ½ã€‚",2],
["leads to","å¯¼è‡´","Overfitting leads to poor results.","è¿‡æ‹Ÿåˆå¯¼è‡´å·®ç»“æœã€‚",2],
["depends on","å–å†³äº","Performance depends on data quality.","æ€§èƒ½å–å†³äºæ•°æ®è´¨é‡ã€‚",2],
["consists of","ç”±â€¦ç»„æˆ","The model consists of 12 layers.","æ¨¡å‹ç”±12å±‚ç»„æˆã€‚",2],
["is designed to","æ—¨åœ¨","This tool is designed to help.","è¿™å·¥å…·æ—¨åœ¨å¸®åŠ©äººã€‚",2],
["is used for","ç”¨äº","GPT is used for text generation.","GPTç”¨äºæ–‡æœ¬ç”Ÿæˆã€‚",2],
["is known as","è¢«ç§°ä¸º","This is known as transfer learning.","è¿™è¢«ç§°ä¸ºè¿ç§»å­¦ä¹ ã€‚",2],
["as a result","å› æ­¤","As a result, it performs better.","å› æ­¤å®ƒè¡¨ç°æ›´å¥½ã€‚",2],
["in addition","æ­¤å¤–","In addition, we tested on more data.","æ­¤å¤–æˆ‘ä»¬æµ‹è¯•äº†æ›´å¤šã€‚",2],
["furthermore","è€Œä¸”","Furthermore, the method is faster.","è€Œä¸”æ–¹æ³•æ›´å¿«ã€‚",2],
["in terms of","åœ¨â€¦æ–¹é¢","In terms of speed, model A wins.","é€Ÿåº¦æ–¹é¢æ¨¡å‹Aèƒœå‡ºã€‚",2],
["rather than","è€Œä¸æ˜¯","Fine-tune rather than retrain.","å¾®è°ƒè€Œéé‡æ–°è®­ç»ƒã€‚",2],
["instead of","ä»£æ›¿","Use Python instead of Java.","ç”¨Pythonä»£æ›¿Javaã€‚",2],
["we propose","æˆ‘ä»¬æå‡º","We propose a new architecture.","æˆ‘ä»¬æå‡ºæ–°æ¶æ„ã€‚",2],
["we demonstrate","æˆ‘ä»¬è¯æ˜","We demonstrate it works.","æˆ‘ä»¬è¯æ˜å®ƒæœ‰æ•ˆã€‚",2],
["according to","æ ¹æ®","According to the results.","æ ¹æ®ç»“æœã€‚",2],
["in contrast","ç›¸å","In contrast, ours is simpler.","ç›¸åæˆ‘ä»¬çš„æ›´ç®€å•ã€‚",2]
];

// ===== GRAMMAR DATA =====
const GRAMMAR=[
{t:"ä¸»è°“å®¾ç»“æ„ (SVO)",d:"è‹±è¯­æœ€åŸºæœ¬çš„å¥å­ç»“æ„æ˜¯ã€Œä¸»è¯­ + åŠ¨è¯ + å®¾è¯­ã€ã€‚æŠ€æœ¯æ–‡ç« ä¸­çš„ç®€å•é™ˆè¿°å¥éƒ½ç”¨è¿™ä¸ªç»“æ„ã€‚æŒæ¡è¿™ä¸ªç»“æ„æ˜¯é˜…è¯»çš„åŸºç¡€ã€‚",ex:[
["The model processes the data.","æ¨¡å‹å¤„ç†æ•°æ®ã€‚","model=ä¸»è¯­, processes=åŠ¨è¯, data=å®¾è¯­"],
["This algorithm solves the problem.","è¿™ä¸ªç®—æ³•è§£å†³é—®é¢˜ã€‚","algorithm=ä¸», solves=åŠ¨, problem=å®¾"],
["We trained a new model.","æˆ‘ä»¬è®­ç»ƒäº†æ–°æ¨¡å‹ã€‚","We=ä¸», trained=åŠ¨, model=å®¾"],
["The team released an update.","å›¢é˜Ÿå‘å¸ƒäº†æ›´æ–°ã€‚","team=ä¸», released=åŠ¨, update=å®¾"]]},
{t:"è¢«åŠ¨è¯­æ€ (Passive Voice)",d:"æŠ€æœ¯æ–‡ç« ä¸­è¶…è¿‡40%çš„å¥å­ç”¨è¢«åŠ¨è¯­æ€ï¼ç»“æ„æ˜¯ï¼šä¸»è¯­ + is/are/was/were + è¿‡å»åˆ†è¯ã€‚å½“æˆ‘ä»¬æ›´å…³å¿ƒã€Œå‘ç”Ÿäº†ä»€ä¹ˆã€è€Œä¸æ˜¯ã€Œè°åšçš„ã€æ—¶ï¼Œå°±ç”¨è¢«åŠ¨è¯­æ€ã€‚",ex:[
["The model is trained on large data.","æ¨¡å‹åœ¨å¤§æ•°æ®ä¸Šè¢«è®­ç»ƒã€‚","is trained = è¢«åŠ¨è¯­æ€"],
["Results were shown in Table 1.","ç»“æœåœ¨è¡¨1ä¸­å±•ç¤ºã€‚","were shown = è¢«åŠ¨è¯­æ€"],
["The method was proposed in 2023.","è¯¥æ–¹æ³•åœ¨2023å¹´è¢«æå‡ºã€‚","was proposed = è¢«åŠ¨è¯­æ€"],
["Features are extracted automatically.","ç‰¹å¾è¢«è‡ªåŠ¨æå–ã€‚","are extracted = è¢«åŠ¨è¯­æ€"]]},
{t:"æ¡ä»¶å¥ (If-conditionals)",d:"ç”¨ if å¼•å¯¼ä¸€ä¸ªæ¡ä»¶ï¼Œåé¢è·Ÿç»“æœã€‚æŠ€æœ¯æ–‡ç« ä¸­å¸¸ç”¨äºæè¿°å› æœå…³ç³»å’Œä½¿ç”¨å»ºè®®ã€‚ç»“æ„ï¼šIf + æ¡ä»¶, ç»“æœã€‚",ex:[
["If the loss decreases, the model is learning.","å¦‚æœæŸå¤±ä¸‹é™ï¼Œæ¨¡å‹åœ¨å­¦ä¹ ã€‚","if + æ¡ä»¶ â†’ ç»“æœ"],
["If you use more data, accuracy will improve.","ç”¨æ›´å¤šæ•°æ®å‡†ç¡®ç‡ä¼šæé«˜ã€‚","if + æ¡ä»¶ â†’ will + ç»“æœ"],
["If the model overfits, try dropout.","å¦‚æœè¿‡æ‹Ÿåˆï¼Œè¯•è¯•dropoutã€‚","if + æ¡ä»¶ â†’ å»ºè®®"]]},
{t:"åŠ¨åè¯ä½œä¸»è¯­ (-ing as subject)",d:"åŠ¨è¯çš„ -ing å½¢å¼æ”¾åœ¨å¥é¦–åšä¸»è¯­ï¼Œåœ¨æŠ€æœ¯æ–‡ç« ä¸­éå¸¸å¸¸è§ã€‚æ¯”å¦‚ Training... / Fine-tuning... / Using... å¼€å¤´çš„å¥å­ã€‚",ex:[
["Training large models requires GPUs.","è®­ç»ƒå¤§æ¨¡å‹éœ€è¦GPUã€‚","Training = åŠ¨åè¯åšä¸»è¯­"],
["Fine-tuning improves task performance.","å¾®è°ƒæå‡ä»»åŠ¡æ€§èƒ½ã€‚","Fine-tuning = åŠ¨åè¯åšä¸»è¯­"],
["Using attention helps the model focus.","ä½¿ç”¨æ³¨æ„åŠ›å¸®åŠ©æ¨¡å‹èšç„¦ã€‚","Using = åŠ¨åè¯åšä¸»è¯­"]]},
{t:"å®šè¯­ä»å¥ (that/which)",d:"ç”¨ that æˆ– which å¼•å¯¼çš„ä»å¥æ¥ä¿®é¥°å‰é¢çš„åè¯ã€‚that ç”¨äºé™åˆ¶æ€§ä»å¥ï¼ˆä¸å¯çœç•¥ï¼‰ï¼Œwhich ç”¨äºéé™åˆ¶æ€§ä»å¥ï¼ˆå‰é¢æœ‰é€—å·ï¼Œè¡¥å……è¯´æ˜ï¼‰ã€‚",ex:[
["Models that use attention perform better.","ä½¿ç”¨æ³¨æ„åŠ›çš„æ¨¡å‹è¡¨ç°æ›´å¥½ã€‚","that use attention ä¿®é¥° Models"],
["The dataset, which has 1M samples, is large.","æ•°æ®é›†æœ‰100ä¸‡æ ·æœ¬ï¼Œå¾ˆå¤§ã€‚","which... è¡¥å……è¯´æ˜ dataset"],
["Methods that reduce overfitting are important.","å‡å°‘è¿‡æ‹Ÿåˆçš„æ–¹æ³•å¾ˆé‡è¦ã€‚","that reduce... ä¿®é¥° Methods"]]}
];

// ===== TOOLS DATA =====
const TOOLS=[
{n:"DeepSeek (æ·±åº¦æ±‚ç´¢)",d:"å®Œå…¨å…è´¹çš„AIåŠ©æ‰‹ï¼Œæ›¿ä»£ChatGPTã€‚æ”¯æŒä¸­è‹±åŒè¯­ï¼Œå¯ä»¥å¸®ä½ è§£é‡Šè‹±è¯­è¯­æ³•ã€åˆ†æå¥å­ç»“æ„ã€å­¦ä¹ è¯æ±‡ã€‚æ— éœ€VPNï¼Œå›½å†…ç›´æ¥è®¿é—®ã€‚",url:"https://chat.deepseek.com",tip:"æç¤ºè¯æ¨¡æ¿ï¼šã€Œè¯·ç”¨ä¸­æ–‡å¸®æˆ‘åˆ†æè¿™ä¸ªè‹±è¯­å¥å­çš„è¯­æ³•ç»“æ„ï¼š[ç²˜è´´å¥å­]ã€"},
{n:"AnkiDroid (Androidå…è´¹)",d:"ä¸“ä¸šçš„é—´éš”é‡å¤èƒŒè¯å·¥å…·ï¼Œæ¯”æœ¬ç½‘é¡µçš„é—ªå¡åŠŸèƒ½æ›´å¼ºå¤§ã€‚é€‚åˆæƒ³è¦è¿›é˜¶çš„åŒå­¦ã€‚åœ¨Google Playæˆ–åº”ç”¨å¸‚åœºæœç´¢å®‰è£…ã€‚",url:"https://github.com/ankidroid/Anki-Android/releases",tip:"æœç´¢å…±äº«å¡ç»„ â†’ è¾“å…¥ Machine Learning Vocabulary"},
{n:"æ²‰æµ¸å¼ç¿»è¯‘",d:"æµè§ˆå™¨æ‰©å±•ï¼Œå®ç°ç½‘é¡µåŒè¯­å¯¹ç…§é˜…è¯»ã€‚Androidå¯åœ¨ Kiwiæµè§ˆå™¨ æˆ– Firefox ä¸­å®‰è£…ä½¿ç”¨ã€‚çœ‹è‹±æ–‡ç½‘é¡µæ—¶è‡ªåŠ¨æ˜¾ç¤ºä¸­è‹±å¯¹ç…§ã€‚",url:"https://immersivetranslate.com",tip:"å®‰è£…åæ‰“å¼€ä»»ä½•è‹±æ–‡ç½‘é¡µ â†’ ç‚¹å‡»æ‰©å±•å›¾æ ‡ â†’ ä¸€é”®åŒè¯­å¯¹ç…§"}
];

// ===== APP STATE =====
const STORE_KEY='ael-data';
let state=loadState();

function defaultState(){
  return{
    streak:0,lastDate:null,
    cards:{},// {id:{iv:1,rep:0,last:null,ease:2.5}}
    settings:{dailyNew:10,dailyReview:50},
    milestones:{},
    todayNew:0,todayRev:0,todayDate:null
  };
}

function loadState(){
  try{const s=localStorage.getItem(STORE_KEY);return s?JSON.parse(s):defaultState();}
  catch(e){return defaultState();}
}

function saveState(){localStorage.setItem(STORE_KEY,JSON.stringify(state));}

// ===== NAVIGATION =====
function go(page){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById('pg-'+page).classList.add('active');
  document.querySelectorAll('.nav-item').forEach((n,i)=>{
    n.classList.toggle('active',['home','cards','grammar','plan','settings'][i]===page);
  });
  if(page==='home')refreshHome();
  if(page==='cards')initCards();
  if(page==='grammar')renderGrammar();
  if(page==='plan')renderPlan();
  if(page==='settings')renderSettings();
}

function goHome(){go('home');}
function startStudy(){go('cards');}

// ===== DATE UTILS =====
function today(){return new Date().toISOString().slice(0,10);}
function daysBetween(a,b){
  if(!a||!b)return 999;
  return Math.floor((new Date(b)-new Date(a))/(86400000));
}

// ===== STREAK =====
function updateStreak(){
  const t=today();
  if(state.lastDate===t)return;
  const d=daysBetween(state.lastDate,t);
  if(d===1)state.streak++;
  else if(d>1)state.streak=1;
  else if(!state.lastDate)state.streak=1;
  state.lastDate=t;
  saveState();
}

// ===== HOME =====
function refreshHome(){
  const t=today();
  // Reset daily counters if new day
  if(state.todayDate!==t){
    state.todayNew=0;state.todayRev=0;state.todayDate=t;
    saveState();
  }
  
  document.getElementById('streak').textContent=state.streak;
  
  // Count learned words
  let learned=0;
  for(let id in state.cards){
    if(state.cards[id].iv>=4)learned++;
  }
  document.getElementById('learned').textContent=learned;
  document.getElementById('total-words').textContent=V.length;
  
  // Phase
  let phase=1;
  if(learned>=100)phase=2;
  if(learned>=V.length-20)phase=3;
  const phaseEl=document.getElementById('phase-indicator');
  phaseEl.innerHTML=`<span class="phase-badge phase-${phase}">ç¬¬${phase}é˜¶æ®µ Â· ${['åŸºç¡€è¯æ±‡','çŸ­è¯­æ­é…','ç‹¬ç«‹é˜…è¯»'][phase-1]}</span>`;
  
  // Today tasks
  const {newCards,reviewCards}=getDueCards();
  const tasksEl=document.getElementById('today-tasks');
  const newLeft=Math.min(newCards.length,state.settings.dailyNew-state.todayNew);
  const revLeft=Math.min(reviewCards.length,state.settings.dailyReview-state.todayRev);
  if(newLeft<=0&&revLeft<=0){
    tasksEl.innerHTML='âœ… ä»Šæ—¥ä»»åŠ¡å·²å®Œæˆï¼æ˜å¤©ç»§ç»­åŠ æ²¹ ğŸ’ª';
  }else{
    tasksEl.innerHTML=`
      ğŸ“– æ–°è¯å­¦ä¹ ï¼š${Math.max(0,newLeft)} ä¸ª<br>
      ğŸ”„ å¤ä¹ å·©å›ºï¼š${Math.max(0,revLeft)} ä¸ª<br>
      â±ï¸ é¢„è®¡ç”¨æ—¶ï¼š${Math.ceil((Math.max(0,newLeft)+Math.max(0,revLeft))*0.3)} åˆ†é’Ÿ
    `;
  }
  
  // Greeting
  const h=new Date().getHours();
  const greetings=['ğŸŒ™ å¤œæ·±äº†ï¼Œæ³¨æ„ä¼‘æ¯','â˜€ï¸ æ—©ä¸Šå¥½ï¼æ–°çš„ä¸€å¤©','ğŸŒ¤ï¸ ä¸Šåˆå¥½','ğŸœ ä¸­åˆå¥½','â˜€ï¸ ä¸‹åˆå¥½','ğŸŒ† å‚æ™šå¥½','ğŸŒ™ æ™šä¸Šå¥½'];
  const gi=h<6?0:h<9?1:h<12?2:h<13?3:h<17?4:h<19?5:6;
  document.getElementById('greeting').textContent=greetings[gi];
}

// ===== FLASHCARD SYSTEM =====
let currentQueue=[];
let currentIdx=0;
let sessionNew=0;
let sessionRev=0;

function getDueCards(){
  const t=today();
  const newCards=[];
  const reviewCards=[];
  
  V.forEach((v,i)=>{
    const id='w'+i;
    const c=state.cards[id];
    if(!c){
      newCards.push(i);
    }else{
      const daysSince=daysBetween(c.last,t);
      if(daysSince>=c.iv){
        reviewCards.push(i);
      }
    }
  });
  
  return{newCards,reviewCards};
}

function initCards(){
  const t=today();
  if(state.todayDate!==t){
    state.todayNew=0;state.todayRev=0;state.todayDate=t;
    saveState();
  }
  
  const{newCards,reviewCards}=getDueCards();
  currentQueue=[];
  
  // Add review cards first
  const revLimit=Math.min(reviewCards.length,state.settings.dailyReview-state.todayRev);
  for(let i=0;i<revLimit;i++)currentQueue.push({idx:reviewCards[i],isNew:false});
  
  // Then new cards
  const newLimit=Math.min(newCards.length,state.settings.dailyNew-state.todayNew);
  for(let i=0;i<newLimit;i++)currentQueue.push({idx:newCards[i],isNew:true});
  
  // Shuffle
  for(let i=currentQueue.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [currentQueue[i],currentQueue[j]]=[currentQueue[j],currentQueue[i]];
  }
  
  currentIdx=0;sessionNew=0;sessionRev=0;
  
  if(currentQueue.length===0){
    showDone();
  }else{
    showCard();
  }
  
  updateCardUI();
}

function showCard(){
  if(currentIdx>=currentQueue.length){showDone();return;}
  
  const item=currentQueue[currentIdx];
  const v=V[item.idx];
  
  document.getElementById('fc-card').classList.remove('flipped');
  document.getElementById('fc-word').textContent=v[0];
  document.getElementById('fc-cn').textContent=v[1];
  document.getElementById('fc-ex').textContent=v[2];
  document.getElementById('fc-excn').textContent=v[3];
  document.getElementById('fc-phase-tag').textContent='é˜¶æ®µ'+v[4];
  
  document.getElementById('fc-area').style.display='';
  document.getElementById('fc-btns').style.display='none';
  document.getElementById('fc-done').style.display='none';
  
  updateCardUI();
}

function flipCard(){
  const card=document.getElementById('fc-card');
  if(!card.classList.contains('flipped')){
    card.classList.add('flipped');
    document.getElementById('fc-btns').style.display='flex';
  }
}

function answer(level){
  // level: 0=wrong, 1=fuzzy, 2=correct
  const item=currentQueue[currentIdx];
  const id='w'+item.idx;
  let c=state.cards[id]||{iv:1,rep:0,last:null};
  
  const t=today();
  if(level===0){
    c.iv=1;c.rep=0;
  }else if(level===1){
    // keep same interval
    c.rep++;
  }else{
    if(c.iv<2)c.iv=2;
    else if(c.iv<4)c.iv=4;
    else if(c.iv<8)c.iv=8;
    else if(c.iv<16)c.iv=16;
    else c.iv=30;
    c.rep++;
  }
  c.last=t;
  state.cards[id]=c;
  
  if(item.isNew)state.todayNew++;
  else state.todayRev++;
  
  if(item.isNew)sessionNew++;
  else sessionRev++;
  
  updateStreak();
  saveState();
  
  currentIdx++;
  showCard();
}

function showDone(){
  document.getElementById('fc-area').style.display='none';
  document.getElementById('fc-btns').style.display='none';
  document.getElementById('fc-done').style.display='';
  document.getElementById('fc-summary').textContent=
    `æœ¬æ¬¡å­¦ä¹ ï¼š${sessionNew}ä¸ªæ–°è¯ + ${sessionRev}ä¸ªå¤ä¹ `;
}

function updateCardUI(){
  const total=currentQueue.length;
  const done=currentIdx;
  document.getElementById('fc-count').textContent=`${done} / ${total}`;
  document.getElementById('fc-new-count').textContent=`æ–°è¯: ${sessionNew} | å¤ä¹ : ${sessionRev}`;
  const pct=total>0?(done/total*100):0;
  document.getElementById('fc-bar').style.width=pct+'%';
}

// ===== GRAMMAR =====
function renderGrammar(){
  const el=document.getElementById('grammar-list');
  el.innerHTML=GRAMMAR.map((g,i)=>`
    <div class="grammar-item" id="gi-${i}">
      <div class="grammar-header" onclick="toggleGrammar(${i})">
        <span>${g.t}</span>
        <span class="arrow">â–¼</span>
      </div>
      <div class="grammar-body">
        <div class="grammar-desc">${g.d}</div>
        ${g.ex.map(e=>`
          <div class="grammar-ex">
            <div class="en">${e[0]}</div>
            <div class="cn">${e[1]}</div>
            <div class="note">ğŸ’¡ ${e[2]}</div>
          </div>
        `).join('')}
      </div>
    </div>
  `).join('');
}

function toggleGrammar(i){
  document.getElementById('gi-'+i).classList.toggle('open');
}

// ===== PLAN =====
function renderPlan(){
  const el=document.getElementById('plan-content');
  const phases=[
    {t:"ç¬¬1é˜¶æ®µï¼šæ‰“åœ°åŸº",sub:"ç¬¬1-2æœˆ Â· åŸºç¡€è¯æ±‡+è¯­æ³•éª¨æ¶",items:[
      "å®‰è£…å¹¶è®¾ç½®å¥½å­¦ä¹ å·¥å…·ï¼ˆæœ¬ç½‘é¡µ+DeepSeekï¼‰",
      "å­¦å®Œå‰50ä¸ªåŸºç¡€è‹±è¯­è¯æ±‡ï¼ˆåŠ¨è¯ã€è¿è¯ã€ä»‹è¯ï¼‰",
      "å­¦å®Œ5ä¸ªè¯­æ³•éª¨æ¶ï¼ˆå»è¯­æ³•é¡µé¢å­¦ä¹ ï¼‰",
      "å­¦å®Œ50ä¸ªAIæ ¸å¿ƒæœ¯è¯­ï¼ˆmodel, training, neural network...ï¼‰",
      "èƒ½çœ‹æ‡‚ The model is trained on a large dataset è¿™æ ·çš„å¥å­",
      "Anki/æœ¬ç½‘é¡µ è¿ç»­å­¦ä¹ 30å¤©",
      "åœ¨ Google ML Glossary ä¸Šéšæœºè®¤å‡º5ä¸ªè¯æ¡"
    ]},
    {t:"ç¬¬2é˜¶æ®µï¼šèµ·é£",sub:"ç¬¬3-4æœˆ Â· çŸ­è¯­æ­é…+åŒè¯­é˜…è¯»",items:[
      "å­¦å®Œæ‰€æœ‰Phase 2çŸ­è¯­ï¼ˆbased on, compared to...ï¼‰",
      "å®‰è£…æ²‰æµ¸å¼ç¿»è¯‘ï¼Œå¼€å§‹åŒè¯­å¯¹ç…§é˜…è¯»",
      "ç”¨DeepSeekåˆ†æ3ç¯‡æŠ€æœ¯æ–‡ç« ä¸­çš„éš¾å¥",
      "èƒ½å¤§è‡´è¯»æ‡‚ The Batch Newsletter çš„æ–‡ç« æ ‡é¢˜å’Œä¸»æ—¨",
      "æ‰“å¼€GitHubçƒ­é—¨é¡¹ç›®READMEèƒ½çœ‹æ‡‚å®‰è£…æ­¥éª¤",
      "ç¿»è¯‘å·¥å…·ä½¿ç”¨é¢‘ç‡é™ä½åˆ°æ¯æ®µæŸ¥1-2ä¸ªè¯"
    ]},
    {t:"ç¬¬3é˜¶æ®µï¼šç‹¬ç«‹é˜…è¯»",sub:"ç¬¬5-6æœˆ Â· è„±ç¦»ç¿»è¯‘+å®æˆ˜é˜…è¯»",items:[
      "å…³é—­ç¿»è¯‘å·¥å…·ç›´æ¥é˜…è¯»è‹±æ–‡AIåšå®¢",
      "èƒ½è¯»æ‡‚HuggingFace Blogæ–‡ç« 70%ä»¥ä¸Šå†…å®¹",
      "èƒ½é˜…è¯»arXivè®ºæ–‡æ‘˜è¦(Abstract)å¹¶ç†è§£ä¸»æ—¨",
      "åœ¨Reddit/HNä¸Šé˜…è¯»AIç›¸å…³è®¨è®ºå¸–",
      "é‡åˆ°æ–°æ¦‚å¿µèƒ½ç›´æ¥é˜…è¯»è‹±æ–‡æ–‡æ¡£å­¦ä¹ ",
      "ç´¯è®¡æŒæ¡1000+è¯æ±‡"
    ]}
  ];
  
  let learned=0;
  for(let id in state.cards){if(state.cards[id].iv>=4)learned++;}
  let curPhase=1;
  if(learned>=100)curPhase=2;
  if(learned>=V.length-20)curPhase=3;
  
  el.innerHTML='<div class="timeline">'+phases.map((p,pi)=>{
    const phaseNum=pi+1;
    const isDone=phaseNum<curPhase;
    const isActive=phaseNum===curPhase;
    return`
      <div class="phase-block">
        <div class="phase-dot ${isDone?'done':isActive?'active':''}"></div>
        <div class="phase-title" style="color:${isDone?'var(--accent)':isActive?'#fff':'var(--text3)'}">
          ${isDone?'âœ… ':''}${p.t}
        </div>
        <div style="font-size:12px;color:var(--text3);margin-bottom:10px">${p.sub}</div>
        ${p.items.map((item,ii)=>{
          const mid='m'+pi+'_'+ii;
          const checked=state.milestones[mid]||false;
          return`<div class="milestone" onclick="toggleMilestone('${mid}',this)">
            <input type="checkbox" ${checked?'checked':''} onclick="event.stopPropagation()">
            <span>${item}</span>
          </div>`;
        }).join('')}
      </div>
    `;
  }).join('')+'</div>';
}

function toggleMilestone(id,el){
  const cb=el.querySelector('input');
  cb.checked=!cb.checked;
  state.milestones[id]=cb.checked;
  saveState();
}

// ===== SETTINGS =====
function renderSettings(){
  document.getElementById('new-slider').value=state.settings.dailyNew;
  document.getElementById('new-val').textContent=state.settings.dailyNew;
  document.getElementById('rev-slider').value=state.settings.dailyReview;
  document.getElementById('rev-val').textContent=state.settings.dailyReview;
  
  const toolsEl=document.getElementById('tools-list');
  toolsEl.innerHTML=TOOLS.map(t=>`
    <div class="tool-card">
      <div class="tool-name">${t.n}</div>
      <div class="tool-desc">${t.d}</div>
      <div class="tool-tip">ğŸ’¡ ${t.tip}</div>
      <a class="tool-url" href="${t.url}" target="_blank">ğŸ”— æ‰“å¼€é“¾æ¥</a>
    </div>
  `).join('');
}

function updateSetting(type,val){
  val=parseInt(val);
  if(type==='new'){
    state.settings.dailyNew=val;
    document.getElementById('new-val').textContent=val;
  }else{
    state.settings.dailyReview=val;
    document.getElementById('rev-val').textContent=val;
  }
  saveState();
}

function showModal(){document.getElementById('modal').classList.add('show');}
function hideModal(){document.getElementById('modal').classList.remove('show');}

function resetAll(){
  localStorage.removeItem(STORE_KEY);
  state=defaultState();
  hideModal();
  go('home');
}

function exportData(){
  const blob=new Blob([JSON.stringify(state,null,2)],{type:'application/json'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;a.download='ai-english-backup-'+today()+'.json';
  a.click();URL.revokeObjectURL(url);
}

function importData(e){
  const file=e.target.files[0];
  if(!file)return;
  const reader=new FileReader();
  reader.onload=function(ev){
    try{
      state=JSON.parse(ev.target.result);
      saveState();
      go('home');
    }catch(err){
      // show error inline instead of alert
      const el=document.createElement('div');
      el.style.cssText='position:fixed;top:20px;left:20px;right:20px;background:var(--err);color:#fff;padding:12px;border-radius:8px;z-index:300;text-align:center';
      el.textContent='âŒ æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œå¯¼å…¥å¤±è´¥';
      document.body.appendChild(el);
      setTimeout(()=>el.remove(),3000);
    }
  };
  reader.readAsText(file);
  e.target.value='';
}

// ===== INIT =====
refreshHome();
</script>
</body>
</html>
